<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body id = "background" style="background-color: blue;">
    <audio controls>
        <source src="recording.wav",type="audio/wav">
    </audio>

    <audio controls id= "recorded">
    </audio>
    <button id = "start_but">start recording</button>
    <button id = "stop_but">stop recording</button>
    <script>
        const startButton = document.getElementById("start_but");
        const stopButton = document.getElementById("stop_but");
        const audio = document.getElementById("recorded");
        const bg = document.getElementById("background");

        if (navigator.mediaDevices){
            console.log("supported");
        }
        let recordedStream = [];
        navigator.mediaDevices.getUserMedia({audio:true}).then((stream) => {const audioStream = new MediaRecorder(stream)
        startButton.onclick = () => {
            // console.log('nice');
            audioStream.start();
            console.log(audioStream.state);
            bg.style.background="red";
        }

        stopButton.onclick = () => {
            audioStream.stop();
            console.log(audioStream.state);
            bg.style.background="blue";
        }

        audioStream.onstop = (e) => {
            const blob = new Blob(recordedStream, {type: "audio/wav"});
            recordedStream = [];
            const audioURL = URL.createObjectURL(blob);
            audio.src = audioURL;
            console.log("file upload")
        }
        
        audioStream.ondataavailable = (e) =>{
            recordedStream.push(e.data);
        }
        }).catch((err)=>{
            console.log("problem occurred");
        });
    </script>
</body>
</html>